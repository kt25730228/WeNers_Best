<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>로그인 | WeNers</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="config.js"></script>

<style>
body { font-family: system-ui, -apple-system, sans-serif; }
</style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

<div class="w-full max-w-sm bg-white p-8 rounded-xl shadow-2xl">
    <h2 class="text-3xl font-bold text-gray-800 text-center mb-8">로그인</h2>

    <form id="loginForm" onsubmit="login(event)" class="space-y-4">
        <div>
            <label for="email" class="block text-sm font-medium text-gray-700">이메일 주소</label>
            <input id="email" type="email" placeholder="이메일 입력" required
                   class="mt-1 w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"/>
        </div>
        
        <div>
            <label for="password" class="block text-sm font-medium text-gray-700">비밀번호</label>
            <input id="password" type="password" placeholder="비밀번호 입력" required
                   class="mt-1 w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"/>
        </div>

        <button type="submit" id="loginBtn" 
                class="w-full p-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition duration-150 ease-in-out">
            로그인
        </button>
    </form>
    
    <p class="text-center mt-6 text-sm">
        계정이 없으신가요? 
        <a href="auth_signup.html" class="text-blue-500 hover:text-blue-700 font-medium">회원가입하기</a>
    </p>
</div>

<script>
let supabase = window.supabase;

// DOMContentLoaded 이후에 window.supabase가 초기화되므로, 여기에 함수를 정의합니다.
async function login(e){
    e.preventDefault();
    if(!window.supabase) return alert('Supabase 클라이언트 초기화 실패. config.js를 확인하세요.');

    const emailEl = document.getElementById('email');
    const passwordEl = document.getElementById('password');
    
    const email = emailEl.value.trim();
    const password = passwordEl.value;

    const { error } = await window.supabase.auth.signInWithPassword({
        email: email,
        password: password
    });

    if(error) return alert("로그인 실패: "+error.message);
    
    alert("로그인 성공!");
    // 로그인 후 메인 페이지로 이동
    location.href="index.html";
}
</script>
</body>
</html>
