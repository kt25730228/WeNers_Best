<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>íšŒì›ê°€ì…</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="config.js"></script> 

<script>
// Supabase ì´ˆê¸°í™” ë¡œì§
const SUPABASE_URL = window.SUPABASE_URL;
const SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY;
let supabase;

if (SUPABASE_URL && SUPABASE_ANON_KEY) {
    supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
        auth: { persistSession: false }
    });
} else {
    console.error('Supabase ì„¤ì • (config.js)ì„ í™•ì¸í•˜ì„¸ìš”.');
}

document.addEventListener("DOMContentLoaded", () => {
    if (!supabase) return alert('Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì‹¤íŒ¨');
    
    // í¼ ëŒ€ì‹  ë²„íŠ¼ì„ ì‚¬ìš©í•œ ê²½ìš°ë¥¼ ê°€ì •í•˜ê³  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë¶™ì…ë‹ˆë‹¤.
    const form = document.getElementById("signupForm") || document.querySelector('button[onclick*="signup"]')?.closest('form');

    if (form) {
        form.addEventListener("submit", async(e)=>{
            e.preventDefault();
            
            const email = document.getElementById("email")?.value.trim();
            const password = document.getElementById("password")?.value;
            
            if (!email || !password) return alert('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');

            //----------------------
            // ğŸ”¥ íšŒì›ê°€ì… ì‹¤í–‰
            //----------------------
            const { error } = await supabase.auth.signUp({
                email, password
            });

            if(error){
                alert("íšŒì›ê°€ì… ì‹¤íŒ¨: " + error.message);
                return;
            }

            alert("íšŒì›ê°€ì… ì„±ê³µ! ì´ë©”ì¼ ì¸ì¦ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
            location.href="auth_login.html";
        });
    } else {
        console.warn("íšŒì›ê°€ì… í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
});
</script>
</head>

<body>
<h2>íšŒì›ê°€ì…</h2>
<form id="signupForm">
  <input type="email" id="email" placeholder="ì´ë©”ì¼" required><br>
  <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" required><br><br>
  <button type="submit">íšŒì›ê°€ì…</button>
</form>
</body>
</html>

