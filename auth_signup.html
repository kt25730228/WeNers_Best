<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>íšŒì›ê°€ì…</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: system-ui, -apple-system, sans-serif; width: 400px; margin: 50px auto; padding: 20px; background-color: #fff;}
  h2 { font-size: 1.5rem; margin-bottom: 20px; color: #1f2937; }
  input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
  button { width: 100%; padding: 10px; background: #2563eb; color: white; font-weight: bold; border-radius: 4px; cursor: pointer; transition: background-color 0.15s; }
</style>
</head>

<body>
<div class="max-w-md mx-auto p-8 bg-white rounded-lg shadow-xl">
    <h2 class="text-2xl font-bold text-center">âœ… íšŒì›ê°€ì…</h2>
    <form id="signupForm">
        <input type="email" id="email" placeholder="ì´ë©”ì¼ ì…ë ¥" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"/><br>
        <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"/><br>
        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">ê°€ì…í•˜ê¸°</button>
    </form>
    <p class="text-center text-sm mt-4">
        <a href="auth_login.html" class="text-blue-600 hover:text-blue-800">ì´ë¯¸ íšŒì›ì´ì‹ ê°€ìš”? ë¡œê·¸ì¸í•˜ê¸°</a>
    </p>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="config.js"></script> 

<script>
// config.jsì—ì„œ ì „ì—­ìœ¼ë¡œ ì„¤ì •ëœ í‚¤/URLì„ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì˜µë‹ˆë‹¤.
const SUPABASE_URL_FROM_WINDOW = window.SUPABASE_URL;
const SUPABASE_ANON_KEY_FROM_WINDOW = window.SUPABASE_ANON_KEY;
let supabase;

if (SUPABASE_URL_FROM_WINDOW && SUPABASE_ANON_KEY_FROM_WINDOW) {
    // ğŸ’¥ FIX ì ìš©: window.supabase ê°ì²´ì—ì„œ createClient í•¨ìˆ˜ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤.
    if (window.supabase && typeof window.supabase.createClient === 'function') {
        supabase = window.supabase.createClient(SUPABASE_URL_FROM_WINDOW, SUPABASE_ANON_KEY_FROM_WINDOW, {
            auth: { persistSession: false }
        });
    } else {
        console.error('Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬(createClient)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. CDN ë¡œë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
} else {
    console.error('Supabase ì„¤ì • (config.js)ì„ í™•ì¸í•˜ì„¸ìš”.');
}

document.addEventListener("DOMContentLoaded", () => {
    if (!supabase) return alert('Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì‹¤íŒ¨');
    
    const form = document.getElementById("signupForm");

    if (form) {
        form.addEventListener("submit", async(e)=>{
            e.preventDefault();
            
            const email = document.getElementById("email")?.value.trim();
            const password = document.getElementById("password")?.value;
            
            if (!email || !password) return alert('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');

            const { error } = await supabase.auth.signUp({
                email, password
            });

            if(error){
                alert("íšŒì›ê°€ì… ì‹¤íŒ¨: " + error.message);
                return;
            }

            alert("íšŒì›ê°€ì… ì„±ê³µ! ì´ë©”ì¼ ì¸ì¦ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
            location.href="auth_login.html";
        });
    }
});
</script>
</body>
</html>
